<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1146px" preserveAspectRatio="none" style="width:702px;height:1146px;" version="1.1" viewBox="0 0 702 1146" width="702px" zoomAndPan="magnify"><defs><filter height="300%" id="f1f44ellfplh5r" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="429.25" cy="20" fill="#000000" filter="url(#f1f44ellfplh5r)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1f44ellfplh5r)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="111" x="373.75" y="50"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="91" x="383.75" y="71.1387">AWS controller</text><rect fill="#FEFECE" filter="url(#f1f44ellfplh5r)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="211" x="323.75" y="103.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="187" x="333.75" y="125.1074">enqueue AWSCluster/Machine</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="105" x="376.75" y="139.0762">for reconciliation</text><rect fill="#FEFECE" filter="url(#f1f44ellfplh5r)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="365.75" y="171.9063"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="107" x="375.75" y="193.0449">fetch AWSCluster</text><polygon fill="#FEFECE" filter="url(#f1f44ellfplh5r)" points="334.25,225.875,524.25,225.875,536.25,237.875,524.25,249.875,334.25,249.875,322.25,237.875,334.25,225.875" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="190" x="334.25" y="241.6831">AWSCluster has spec.IdentityRef?</text><text fill="#666666" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="21" x="301.25" y="235.0449">yes</text><text fill="#666666" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="16" x="536.25" y="235.0449">no</text><polygon fill="#FEFECE" filter="url(#f1f44ellfplh5r)" points="136.5,259.875,367.5,259.875,379.5,271.875,367.5,283.875,136.5,283.875,124.5,271.875,136.5,259.875" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="231" x="136.5" y="275.6831">Referenced object is cluster scoped CRD</text><text fill="#666666" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="21" x="103.5" y="269.0449">yes</text><text fill="#666666" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="16" x="379.5" y="269.0449">no</text><rect fill="#FEFECE" filter="url(#f1f44ellfplh5r)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="209" x="10" y="293.875"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="189" x="20" y="315.0137">fetch cluster scoped resource</text><rect fill="#FEFECE" filter="url(#f1f44ellfplh5r)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="204" x="287.5" y="293.875"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="180" x="297.5" y="315.0137">fetch referenced resource in</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="111" x="334" y="328.9824">same namespace</text><polygon fill="#FEFECE" filter="url(#f1f44ellfplh5r)" points="252,347.8125,264,359.8125,252,371.8125,240,359.8125,252,347.8125" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f1f44ellfplh5r)" height="61.9063" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="219" x="142.5" y="391.8125"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="162" x="169" y="412.9512">set or append referenced</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="199" x="152.5" y="426.9199">resource as OwnerReference to</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="114" x="195" y="440.8887">AWSCluster object</text><rect fill="#FEFECE" filter="url(#f1f44ellfplh5r)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="180" x="162" y="522.7031"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="156" x="172" y="543.8418">construct new credential</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="51" x="226.5" y="557.8105">provider</text><rect fill="#FEFECE" filter="url(#f1f44ellfplh5r)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="194" x="155" y="639.625"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="170" x="165" y="660.7637">store credential provider in</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="38" x="233" y="674.7324">cache</text><polygon fill="#FEFECE" filter="url(#f1f44ellfplh5r)" points="136.5,590.6406,367.5,590.6406,379.5,602.6406,367.5,614.6406,136.5,614.6406,124.5,602.6406,136.5,590.6406" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#666666" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="16" x="256" y="625.7793">no</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="231" x="136.5" y="606.4487">cache contains value for provider.Hash()</text><polygon fill="#FEFECE" filter="url(#f1f44ellfplh5r)" points="252,707.5625,264,719.5625,252,731.5625,240,719.5625,252,707.5625" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f1f44ellfplh5r)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="173" x="165.5" y="751.5625"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="149" x="175.5" y="772.7012">fetch cached credential</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="51" x="226.5" y="786.6699">provider</text><polygon fill="#FEFECE" filter="url(#f1f44ellfplh5r)" points="234.5,473.7188,269.5,473.7188,281.5,485.7188,269.5,497.7188,234.5,497.7188,222.5,485.7188,234.5,473.7188" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#666666" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="16" x="256" y="508.8574">no</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="234.5" y="489.5269">error?</text><text fill="#666666" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="21" x="281.5" y="482.8887">yes</text><ellipse cx="324.5" cy="485.7188" fill="#FFFFFF" filter="url(#f1f44ellfplh5r)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="324.5" cy="485.7188" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1f44ellfplh5r)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="170" x="521.5" y="259.875"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="142" x="533.5" y="281.0137">current mechanism for</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="150" x="531.5" y="294.9824">checking session cache</text><polygon fill="#FEFECE" filter="url(#f1f44ellfplh5r)" points="429.25,809.5,441.25,821.5,429.25,833.5,417.25,821.5,429.25,809.5" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f1f44ellfplh5r)" height="117.7813" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="212" x="323.25" y="853.5"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="173" x="342.75" y="874.6387">call STS::GetCallerIdentity():</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="187" x="333.75" y="888.6074">if (awscluster.AccountID != nil</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="177" x="338.75" y="902.5762">&amp;&amp; awscluster.AccountID !=</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="192" x="333.25" y="916.5449">GetCallerIdentity?) then (error)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="419.25" y="930.5137">stop</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="31" x="413.75" y="944.4824">endif</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="187" x="335.75" y="958.4512">:update awscluster.accountID</text><rect fill="#FEFECE" filter="url(#f1f44ellfplh5r)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="183" x="337.75" y="991.2813"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="163" x="347.75" y="1012.4199">create new service clients</text><rect fill="#FEFECE" filter="url(#f1f44ellfplh5r)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="173" x="342.75" y="1045.25"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="149" x="352.75" y="1066.3887">reconcile AWSCluster or</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="79" x="389.75" y="1080.3574">AWSMachine</text><ellipse cx="429.25" cy="1124.1875" fill="#FFFFFF" filter="url(#f1f44ellfplh5r)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="429.25" cy="1124.1875" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="429.25" x2="429.25" y1="30" y2="50"/><polygon fill="#666666" points="425.25,40,429.25,50,433.25,40,429.25,44" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="429.25" x2="429.25" y1="83.9688" y2="103.9688"/><polygon fill="#666666" points="425.25,93.9688,429.25,103.9688,433.25,93.9688,429.25,97.9688" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="429.25" x2="429.25" y1="151.9063" y2="171.9063"/><polygon fill="#666666" points="425.25,161.9063,429.25,171.9063,433.25,161.9063,429.25,165.9063" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="124.5" x2="114.5" y1="271.875" y2="271.875"/><line style="stroke: #666666; stroke-width: 1.5;" x1="114.5" x2="114.5" y1="271.875" y2="293.875"/><polygon fill="#666666" points="110.5,283.875,114.5,293.875,118.5,283.875,114.5,287.875" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="379.5" x2="389.5" y1="271.875" y2="271.875"/><line style="stroke: #666666; stroke-width: 1.5;" x1="389.5" x2="389.5" y1="271.875" y2="293.875"/><polygon fill="#666666" points="385.5,283.875,389.5,293.875,393.5,283.875,389.5,287.875" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="114.5" x2="114.5" y1="327.8438" y2="359.8125"/><line style="stroke: #666666; stroke-width: 1.5;" x1="114.5" x2="240" y1="359.8125" y2="359.8125"/><polygon fill="#666666" points="230,355.8125,240,359.8125,230,363.8125,234,359.8125" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="389.5" x2="389.5" y1="341.8125" y2="359.8125"/><line style="stroke: #666666; stroke-width: 1.5;" x1="389.5" x2="264" y1="359.8125" y2="359.8125"/><polygon fill="#666666" points="274,355.8125,264,359.8125,274,363.8125,270,359.8125" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="252" x2="252" y1="371.8125" y2="391.8125"/><polygon fill="#666666" points="248,381.8125,252,391.8125,256,381.8125,252,385.8125" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="252" x2="252" y1="614.6406" y2="639.625"/><polygon fill="#666666" points="248,629.625,252,639.625,256,629.625,252,633.625" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="379.5" x2="391.5" y1="602.6406" y2="602.6406"/><polygon fill="#666666" points="387.5,653.5938,391.5,663.5938,395.5,653.5938,391.5,657.5938" style="stroke: #666666; stroke-width: 1.5;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="391.5" x2="391.5" y1="602.6406" y2="719.5625"/><line style="stroke: #666666; stroke-width: 1.5;" x1="391.5" x2="264" y1="719.5625" y2="719.5625"/><polygon fill="#666666" points="274,715.5625,264,719.5625,274,723.5625,270,719.5625" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="252" x2="252" y1="687.5625" y2="707.5625"/><polygon fill="#666666" points="248,697.5625,252,707.5625,256,697.5625,252,701.5625" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="252" x2="252" y1="570.6406" y2="590.6406"/><polygon fill="#666666" points="248,580.6406,252,590.6406,256,580.6406,252,584.6406" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="252" x2="252" y1="731.5625" y2="751.5625"/><polygon fill="#666666" points="248,741.5625,252,751.5625,256,741.5625,252,745.5625" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="252" x2="252" y1="497.7188" y2="522.7031"/><polygon fill="#666666" points="248,512.7031,252,522.7031,256,512.7031,252,516.7031" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="281.5" x2="313.5" y1="485.7188" y2="485.7188"/><polygon fill="#666666" points="303.5,481.7188,313.5,485.7188,303.5,489.7188,307.5,485.7188" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="252" x2="252" y1="799.5" y2="821.5"/><line style="stroke: #666666; stroke-width: 1.5;" x1="252" x2="417.25" y1="821.5" y2="821.5"/><polygon fill="#666666" points="407.25,817.5,417.25,821.5,407.25,825.5,411.25,821.5" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="252" x2="252" y1="453.7188" y2="473.7188"/><polygon fill="#666666" points="248,463.7188,252,473.7188,256,463.7188,252,467.7188" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="322.25" x2="252" y1="237.875" y2="237.875"/><line style="stroke: #666666; stroke-width: 1.5;" x1="252" x2="252" y1="237.875" y2="259.875"/><polygon fill="#666666" points="248,249.875,252,259.875,256,249.875,252,253.875" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="536.25" x2="606.5" y1="237.875" y2="237.875"/><line style="stroke: #666666; stroke-width: 1.5;" x1="606.5" x2="606.5" y1="237.875" y2="259.875"/><polygon fill="#666666" points="602.5,249.875,606.5,259.875,610.5,249.875,606.5,253.875" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="606.5" x2="606.5" y1="307.8125" y2="821.5"/><line style="stroke: #666666; stroke-width: 1.5;" x1="606.5" x2="441.25" y1="821.5" y2="821.5"/><polygon fill="#666666" points="451.25,817.5,441.25,821.5,451.25,825.5,447.25,821.5" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="429.25" x2="429.25" y1="205.875" y2="225.875"/><polygon fill="#666666" points="425.25,215.875,429.25,225.875,433.25,215.875,429.25,219.875" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="429.25" x2="429.25" y1="833.5" y2="853.5"/><polygon fill="#666666" points="425.25,843.5,429.25,853.5,433.25,843.5,429.25,847.5" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="429.25" x2="429.25" y1="971.2813" y2="991.2813"/><polygon fill="#666666" points="425.25,981.2813,429.25,991.2813,433.25,981.2813,429.25,985.2813" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="429.25" x2="429.25" y1="1025.25" y2="1045.25"/><polygon fill="#666666" points="425.25,1035.25,429.25,1045.25,433.25,1035.25,429.25,1039.25" style="stroke: #666666; stroke-width: 1.0;"/><line style="stroke: #666666; stroke-width: 1.5;" x1="429.25" x2="429.25" y1="1093.1875" y2="1113.1875"/><polygon fill="#666666" points="425.25,1103.1875,429.25,1113.1875,433.25,1103.1875,429.25,1107.1875" style="stroke: #666666; stroke-width: 1.0;"/><!--
@startuml 20200506-single-controller-multitenancy-flow





skinparam defaultTextAlignment center

skinparam wrapWidth 200
skinparam maxMessageSize 150

skinparam rectangle {
    StereotypeFontSize 12
    shadowing false
}

skinparam database {
    StereotypeFontSize 12
    shadowing false
}

skinparam Arrow {
    Color #666666
    FontColor #666666
    FontSize 12
}

skinparam rectangle<<boundary>> {
    Shadowing false
    StereotypeFontSize 0
    FontColor #444444
    BorderColor #444444
    BorderStyle dashed
}






















skinparam rectangle<<person>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #08427B
    BorderColor #073B6F
}

skinparam rectangle<<external_person>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #686868
    BorderColor #8A8A8A
}

skinparam rectangle<<system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #1168BD
    BorderColor #3C7FC0
}

skinparam rectangle<<external_system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #999999
    BorderColor #8A8A8A
}

skinparam database<<system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #1168BD
    BorderColor #3C7FC0
}

skinparam database<<external_system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #999999
    BorderColor #8A8A8A
}
















skinparam rectangle<<container>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #438DD5
    BorderColor #3C7FC0
}

skinparam database<<container>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #438DD5
    BorderColor #3C7FC0
}








start
:AWS controller;
:enqueue AWSCluster/Machine for reconciliation;
:fetch AWSCluster;
if (AWSCluster has spec.IdentityRef?) then (yes)
  if (Referenced object is cluster scoped CRD) then (yes)
    :fetch cluster scoped resource;
  else (no)
    :fetch referenced resource in same namespace;
  endif
  :set or append referenced resource as OwnerReference to AWSCluster object;
  if (error?) then (yes)
    stop
  else (no)
    :construct new credential provider;
    if (cache contains value for provider.Hash()) then (no)
      :store credential provider in cache;
    endif
    :fetch cached credential provider;
  endif
else (no)
  :current mechanism for checking session cache;
endif
:call STS::GetCallerIdentity():
if (awscluster.AccountID != nil && awscluster.AccountID != GetCallerIdentity?) then (error)
  stop
endif
:update awscluster.accountID;
:create new service clients;
:reconcile AWSCluster or AWSMachine;
stop

@enduml

PlantUML version 1.2019.06(Fri May 24 17:10:25 UTC 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_252-b09
Operating System: Linux
OS Version: 5.6.13-300.fc32.x86_64
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>